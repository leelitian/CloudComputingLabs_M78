package lab2;

import java.io.BufferedReader;
import java.io.DataOutputStream;
import java.io.IOException; 
import java.io.InputStreamReader; 
import java.io.PrintWriter; 
import java.net.HttpURLConnection; 
import java.net.URL; 
   
public class httpclient { 
    //发送一个GET请求 
    public static String get(String path) throws Exception{ 
        HttpURLConnection httpConn=null; 
        BufferedReader in=null; 
        try { 
            URL url=new URL(path); 
            httpConn=(HttpURLConnection)url.openConnection(); 
            //这里只是对服务器的测试，所以不需要判断getResponseCode()的结果
            httpConn.getResponseCode();
        } catch (IOException e) { 
            e.printStackTrace(); 
        }finally{ 
            //in.close(); 
            httpConn.disconnect(); 
        } 
        return null; 
    } 
    //发送一个GET请求,参数形式key1=value1&key2=value2... 
    public static String post(String path,String params) throws Exception{ 
        //建立连接
        URL url=new URL(path);
        HttpURLConnection httpConn=(HttpURLConnection)url.openConnection();
         
        //设置参数
        httpConn.setDoOutput(true);     //需要输出
        httpConn.setDoInput(true);      //需要输入
        httpConn.setUseCaches(false);   //不允许缓存
        httpConn.setRequestMethod("POST");      //设置POST方式连接
         
        //设置请求属性
        httpConn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
        httpConn.setRequestProperty("Connection", "Keep-Alive");// 维持长连接
        httpConn.setRequestProperty("Charset", "UTF-8");
         
        //连接,也可以不用明文connect，使用下面的httpConn.getOutputStream()会自动connect
        httpConn.connect();
             
        //建立输入流，向指向的URL传入参数
        DataOutputStream dos=new DataOutputStream(httpConn.getOutputStream());
        dos.writeBytes(params);
        dos.flush();
        dos.close();
         
        //获得响应状态
        int resultCode=httpConn.getResponseCode();
        if(HttpURLConnection.HTTP_OK==resultCode){
            StringBuffer sb=new StringBuffer();
            String readLine=new String();
            BufferedReader responseReader=new BufferedReader(new InputStreamReader(httpConn.getInputStream(),"UTF-8"));
            while((readLine=responseReader.readLine())!=null){
                sb.append(readLine).append("\n");
            }
            responseReader.close();
            System.out.println(sb.toString());
        }
		return "123";  
    } 
       
    public static void main(String[] args) throws Exception { 
        //httpclient.get("http://localhost:8999/index.html"); 
        httpclient.post("http://localhost:8999/Post_show", "Name=h"); 
    } 
   
}